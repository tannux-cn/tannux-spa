var layPicker={index:0,indexList:[],offset:{},liHeight:50,selectList:{},textField:"name",valueField:"value",fieldList:{},dataList:{},init:function(c){layPicker.index++;layPicker.indexList.push(layPicker.index);var b=""+layPicker.index;layPicker.fieldList[b]={textField:c.textField||layPicker.textField,valueField:c.valueField||layPicker.valueField};layPicker.offset[b]={start:{},move:{},end:{state:false}};if(c.options){c.data=lay_picker_date.getData(c.options)}layPicker.selectList[b]={};layPicker.dataList[b]=c.data;var a=layPicker.initBody(c,b);$("body").append(a);$(c.elem).attr("readonly",true);$(c.elem).attr("lay-picker-id",b);if(!c.type||c.type!=3){layPicker.initBox(c.data,b);layPicker.initSelect(b);if(c.options){layPicker.setValue(b,lay_picker_date.getVoluation(c.options,layPicker.fieldList[b].valueField))}$(".lay-picker-"+b).on("touchstart",".lay-picker-list-wrap",function(f){if(!layPicker.offset[b].end.state){layPicker.offset[b].end.state=true;var g=f.originalEvent.targetTouches[0];layPicker.offset[b].start.y=g.clientY;var d=$(this).find("ul")[0];layPicker.offset[b].start.top=parseInt(d.style.transform.split(",")[1].replace("px",""))||0}f.stopPropagation()});$(".lay-picker-"+b).on("touchmove",".lay-picker-list-wrap",function(d){var g=d.originalEvent.targetTouches[0];layPicker.offset[b].move.y=g.clientY;var f=layPicker.offset[b].move.y-layPicker.offset[b].start.y+layPicker.offset[b].start.top;$(this).find("ul").css("transform","translate3d(0px, "+f+"px, 0px)");layPicker.offset[b].end.y=f;d.stopPropagation();d.preventDefault()});$(".lay-picker-"+b).on("touchend",".lay-picker-list-wrap",function(m){layPicker.offset[b].end.state=false;var g=layPicker.liHeight;var f=layPicker.offset[b].end.y>=0?1:-1;var o=$(this).find("ul")[0];var d=$(this).attr("index");var p=Math.round(Math.abs(layPicker.offset[b].end.y)/g);var l=f*(p*g);if(l>0){l=0;p=0}else{if(l<-(o.children.length-1)*g){l=-(o.children.length-1)*g;p=o.children.length-1}}$(this).find("ul").css("transform","translate3d(0px, "+l+"px, 0px)");layPicker.selectList[b][d]=p;var n=layPicker.dataList[b];var q=[];for(var j=0;j<=Number(d);j++){var k=n[j];if(k&&k.length>0){var h=k[layPicker.selectList[b][j]];q.push(h)}}if(c.onSelect){c.onSelect(b,d,q)}if(c.options&&(c.options=="date"||c.options=="datetime"||c.options=="datetimesecond")){if(d==1){layPicker.setData(b,d,lay_picker_date.getDay(q))}}m.stopPropagation()});$(".lay-picker-"+b).on("click",".lay-picker-cancel-click",function(d){layPicker.hiden($(this).parents(".lay-picker").attr("lay-index"));if(c.onCancel){c.onCancel(b)}});$(".lay-picker-"+b).on("click",".lay-picker-confirm-click",function(l){layPicker.hiden($(this).parents(".lay-picker").attr("lay-index"));var i=layPicker.dataList[b];var g="",h=[];for(var f in layPicker.selectList[b]){var d=i[Number(f)];if(d&&d.length>0){var j=d[layPicker.selectList[b][f]];if(c.options&&(c.options=="time"||c.options=="timesecond"||c.options=="datetime"||c.options=="datetimesecond")){if(c.options=="time"||c.options=="timesecond"){g+=j[layPicker.fieldList[b].valueField]+":"}else{if((c.options=="datetime"||c.options=="datetimesecond")&&Number(f)==2){g+=j[layPicker.fieldList[b].valueField]+" "}else{if((c.options=="datetime"||c.options=="datetimesecond")&&Number(f)>2){g+=j[layPicker.fieldList[b].valueField]+":"}else{g+=j[layPicker.fieldList[b].valueField]+"-"}}}}else{g+=j[layPicker.fieldList[b].valueField]+"-"}h.push(j)}}if(c.onConfirm){c.onConfirm(b,g.substring(0,g.length-1),h)}})}$(c.elem).on("click",function(d){layPicker.show($(this).attr("lay-picker-id"));if(c.onShow){c.onShow(b)}});$(".lay-picker-"+b).on("click",".lay-picker-shade",function(d){layPicker.hiden($(this).parents(".lay-picker").attr("lay-index"));if(c.onShade){c.onShade(b)}});if(c.onSuccess){c.onSuccess(b,".lay-picker-"+b)}return b},initBody:function(d,b){var c="";c+='<div class="lay-picker lay-picker-'+b+'" lay-index="'+b+'" style="display: none;">';if(d.shade!==false){if(d.shade){c+='	<div class="lay-picker-shade" style="background: rgba(0, 0, 0, '+d.shade+');"></div>'}else{c+='	<div class="lay-picker-shade"></div>'}}if(d.type==3){var a=(d.radius?"border-radius: "+d.radius+"px "+d.radius+"px 0px 0;":"");c+='	<div class="lay-picker-container" style=";transform: translate3d(0px, 100%, 0px);'+a+'">';c+='		<div class="lay-picker-content" style="overflow: auto;">';c+=(d.content||"");c+="		</div>";c+="	</div>";c+="</div>"}else{if(d.type==2){var a=(d.radius?"border-radius: "+d.radius+"px "+d.radius+"px 0px 0;":"");c+='	<div class="lay-picker-container" style="transform: translate3d(0px, 100%, 0px);'+a+'">';if(d.title){c+='		<div class="lay-picker-header" style="'+a+'">';c+='			<div class="lay-picker-title">'+(d.title||"")+"</div>";c+="		</div>"}c+='		<div class="lay-picker-content" style="'+(d.title?"":"margin: 30px 15px;")+'">';c+='			<div class="lay-picker-shadowup"></div>';c+='			<div class="lay-picker-shadowdown"></div>';c+='			<div class="lay-picker-box"></div>';c+="		</div>";c+='		<div class="lay-picker-bottom">';c+='			<span class="lay-picker-cancel-click lay-picker-bottom-btn lay-picker-bottom-btn-cancel">取消</span>';c+='			<span class="lay-picker-confirm-click lay-picker-bottom-btn lay-picker-bottom-btn-confirm">确定</span>';c+="		</div>";c+="	</div>";c+="</div>"}else{var a=(d.radius?"border-radius: "+d.radius+"px "+d.radius+"px 0px 0;":"");c+='	<div class="lay-picker-container" style="transform: translate3d(0px, 100%, 0px);'+a+'">';c+='		<div class="lay-picker-header" style="'+a+'">';c+='			<div class="lay-picker-title">'+(d.title||"")+"</div>";c+='			<div class="lay-picker-btn">';c+='				<span class="lay-picker-cancel lay-picker-cancel-click">取消</span>';c+='				<span class="lay-picker-confirm lay-picker-confirm-click">确定</span>';c+="			</div>";c+="		</div>";c+='		<div class="lay-picker-content">';c+='			<div class="lay-picker-shadowup"></div>';c+='			<div class="lay-picker-shadowdown"></div>';c+='			<div class="lay-picker-box"></div>';c+="		</div>";c+="	</div>";c+="</div>"}}return c},initBox:function(c,f){var g=100/c.length;var e=$(".lay-picker-"+f).find(".lay-picker-box");for(var d=0;d<c.length;d++){var a=$('<div index="'+d+'" class="lay-picker-list-wrap" style="width: '+g+'%;"></div>');var h=$('<ul style="transform: translate3d(0px, 0, 0px);"></ul>');for(var b=0;b<c[d].length;b++){var k=$("<li>"+c[d][b][layPicker.fieldList[f].textField]+"</li>");h.append(k)}a.append(h);e.append(a)}},initSelect:function(a){var c=layPicker.dataList[a];for(var b=0;b<c.length;b++){layPicker.selectList[a][b+""]=0}},setData:function(b,d,f,g){var e=(Number(d)+1);var c=$(".lay-picker-"+b).find(".lay-picker-box").find("[index="+e+"]>ul");c.empty();c.css("transform","translate3d(0px, 0px, 0px)");for(var d=0;d<f.length;d++){var a=$("<li>"+f[d][layPicker.fieldList[b].textField]+"</li>");c.append(a)}layPicker.selectList[b][e+""]=0;layPicker.dataList[b][e]=f},setDataTrends:function(f,c,b){var j=(Number(c)+1);if(!b||b.length==0){layPicker.deleteData(f,c,j);var g=100/layPicker.dataList[f].length;$(".lay-picker-"+f).find(".lay-picker-list-wrap").css("width",g+"%");return}var e=j>layPicker.dataList[f].length-1;if(e){layPicker.dataList[f].push(b)}else{layPicker.dataList[f][j]=b;layPicker.deleteData(f,j,j+1)}var d=$(".lay-picker-"+f).find(".lay-picker-box");var g=100/layPicker.dataList[f].length;$(".lay-picker-"+f).find(".lay-picker-list-wrap").css("width",g+"%");if(e){var a=$('<div index="'+j+'" class="lay-picker-list-wrap" style="width: '+g+'%;"><ul style="transform: translate3d(0px, 0, 0px);"></ul></div>');d.append(a)}var h=$(".lay-picker-"+f).find(".lay-picker-box").find("[index="+j+"]>ul");h.empty();h.css("transform","translate3d(0px, 0px, 0px)");for(var c=0;c<b.length;c++){var k=$("<li>"+b[c][layPicker.fieldList[f].textField]+"</li>");h.append(k)}layPicker.selectList[f][j+""]=0},deleteData:function(a,b,c){if(layPicker.dataList[a].length>Number(b)){for(var b=c;b<layPicker.dataList[a].length;b++){layPicker.dataList[a].splice(b,1);$(".lay-picker-"+a).find(".lay-picker-box").find("[index="+b+"]").remove();return layPicker.deleteData(a,b,c)}}},setValue:function(c,g){var f=layPicker.dataList[c];var e=$(".lay-picker-"+c).find(".lay-picker-box");for(var d=0;d<g.length;d++){var a=f[d];for(var b=0;b<a.length;b++){if(a[b][layPicker.fieldList[c].valueField]==g[d][layPicker.fieldList[c].valueField]){layPicker.selectList[c][d+""]=b;var h=b*layPicker.liHeight;e.find("[index="+d+"]>ul").css("transform","translate3d(0px, -"+h+"px, 0px)")}}}},hiden:function(a){$(".lay-picker-"+a).find(".lay-picker-container").css("transform","translate3d(0px, 100%, 0px)");$(".lay-picker-"+a).find(".lay-picker-shade").fadeOut(200);setTimeout(function(){$(".lay-picker-"+a).css("display","none")},100)},show:function(a){$(".lay-picker-"+a).css("display","block");$(".lay-picker-"+a).find(".lay-picker-shade").fadeIn(200);setTimeout(function(){$(".lay-picker-"+a).find(".lay-picker-container").css("transform","translate3d(0px, 0px, 0px)")},10)},remove:function(a){layPicker.hiden(a);setTimeout(function(){$(".lay-picker-"+a).remove()},200);for(var b=0;b<layPicker.indexList.length;b++){if(layPicker.indexList[b]==a){layPicker.indexList.splice(b,1);break}}},removeAll:function(){if(layPicker.indexList.length>0){for(var b=0;b<layPicker.indexList.length;b++){layPicker.hiden(layPicker.indexList[b]);var a=layPicker.indexList[b];layPicker.removeTime(a);layPicker.indexList.splice(b,1);return layPicker.removeAll()}}},removeTime:function(a){setTimeout(function(){$(".lay-picker-"+a).remove()},200)}};var lay_picker_date={getVoluation:function(h,i){var a=lay_picker_date.getDateTime();var f={};f[""+i]=a.year;var c={};c[""+i]=a.month;var b={};b[""+i]=a.day;var d={};d[""+i]=a.hours;var g={};g[""+i]=a.minutes;var e={};e[""+i]=a.seconds;if(h=="year"){return[f]}else{if(h=="month"){return[f,c]}else{if(h=="date"){return[f,c,b]}else{if(h=="time"){return[d,g]}else{if(h=="timesecond"){return[d,g,e]}else{if(h=="datetime"){return[f,c,b,d,g]}else{if(h=="datetimesecond"){return[f,c,b,d,g]}}}}}}}},getData:function(f){if(f=="year"){var e=lay_picker_date.getYear();var b=lay_picker_date.getMonth();return[e]}else{if(f=="month"){var e=lay_picker_date.getYear();var b=lay_picker_date.getMonth();return[e,b]}else{if(f=="date"){var e=lay_picker_date.getYear();var b=lay_picker_date.getMonth();var a=lay_picker_date.getDateTime();var h=lay_picker_date.getDay([{value:a.year},{value:a.month}]);return[e,b,h]}else{if(f=="time"){var d=lay_picker_date.getHours();var c=lay_picker_date.getMinutes();return[d,c]}else{if(f=="timesecond"){var d=lay_picker_date.getHours();var c=lay_picker_date.getMinutes();var g=lay_picker_date.getSeconds();return[d,c,g]}else{if(f=="datetime"){var e=lay_picker_date.getYear();var b=lay_picker_date.getMonth();var a=lay_picker_date.getDateTime();var h=lay_picker_date.getDay([{value:a.year},{value:a.month}]);var d=lay_picker_date.getHours();var c=lay_picker_date.getMinutes();return[e,b,h,d,c]}else{if(f=="datetimesecond"){var e=lay_picker_date.getYear();var b=lay_picker_date.getMonth();var a=lay_picker_date.getDateTime();var h=lay_picker_date.getDay([{value:a.year},{value:a.month}]);var d=lay_picker_date.getHours();var c=lay_picker_date.getMinutes();var g=lay_picker_date.getSeconds();return[e,b,h,d,c,g]}}}}}}}},getDateTime:function(){var c=new Date();var e=c.getFullYear();var f=c.getMonth()+1;f=("00"+f).slice(-2);var b=("00"+c.getDate()).slice(-2);var a=("00"+c.getHours()).slice(-2);var d=("00"+c.getMinutes()).slice(-2);var g=("00"+c.getSeconds()).slice(-2);return{year:e,month:f,day:b,hours:a,minutes:d,seconds:g}},getYear:function(){var a=[],b=new Date();var d=b.getFullYear();for(var c=1990;c<=d+30;c++){a.push({name:c+"年",value:c})}return a},getMonth:function(b){var a=[],c=new Date();for(var d=1;d<=12;d++){var e=("00"+d).slice(-2);a.push({name:d+"月",value:e})}return a},getDay:function(b){var f=b[0].value,h=b[1].value;var c=new Date(Number(f),Number(h),0);var d=c.getDate();var a=[];for(var e=1;e<=d;e++){var g=("00"+e).slice(-2);a.push({name:e+"日",value:g})}return a},getHours:function(b){var a=[],c=new Date();for(var d=0;d<24;d++){var e=("00"+d).slice(-2);a.push({name:e+"时",value:e})}return a},getMinutes:function(b){var a=[],c=new Date();for(var d=0;d<60;d++){var e=("00"+d).slice(-2);a.push({name:e+"分",value:e})}return a},getSeconds:function(b){var a=[],c=new Date();for(var d=0;d<60;d++){var e=("00"+d).slice(-2);a.push({name:e+"秒",value:e})}return a}};